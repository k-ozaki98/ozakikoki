---
import BtnA from "../components/BtnA.tsx"
import ColumnCard from "../components/ColumnCard"
import { newtClient } from "../lib/newt"
import type { Article } from '../lib/newt'

const {items: articles} = await newtClient.getContents<Article>({
  appUid: 'blog',
  modelUid: 'article',
    query: {
      limit: 6,
    },
})
---

<div id="blog" class="blog sec-inner">
  <div class="l-inner blog__inner">
    <div class="blog__text">
      <span class="layer-open blog-trigger">
        <svg id="blog" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 158.22 94.31">
          <path class="blog-path" d="M35,36.97c2.82,1.38,4.99,3.27,6.52,5.68,1.53,2.41,2.3,5.11,2.3,8.12,0,3.32-.81,6.32-2.44,9.01-1.63,2.69-3.86,4.8-6.71,6.33-2.85,1.53-6.02,2.3-9.53,2.3-2.06,0-4.32-.09-6.76-.28-.88-.06-1.91-.12-3.1-.19-1.19-.06-2.5-.09-3.94-.09l-6.38,.09c-1.13,.06-2.72,.09-4.79,.09-.13,0-.19-.19-.19-.56s.06-.56,.19-.56c2.38,0,4.13-.17,5.26-.52,1.13-.34,1.91-.95,2.35-1.83,.44-.88,.66-2.25,.66-4.13V16.99c0-1.88-.2-3.25-.61-4.13-.41-.88-1.17-1.49-2.3-1.83-1.13-.34-2.85-.52-5.16-.52-.19,0-.28-.19-.28-.56s.09-.56,.28-.56l4.6,.09c2.63,.13,4.75,.19,6.38,.19,1.13,0,2.17-.03,3.14-.09,.97-.06,1.8-.12,2.49-.19,2-.19,3.81-.28,5.44-.28,5.25,0,9.2,1.14,11.82,3.43,2.63,2.28,3.94,5.27,3.94,8.96s-1.27,6.52-3.8,9.06c-2.53,2.53-5.9,4.33-10.09,5.4l1.03-1.03c3.63,0,6.85,.69,9.67,2.06ZM16.7,10.89c-.75,.25-1.31,.84-1.69,1.78-.38,.94-.56,2.44-.56,4.5v18.39l-3-.75c2.69,.19,5.1,.28,7.23,.28,4.57,0,7.94-1.17,10.14-3.52,2.19-2.35,3.28-5.46,3.28-9.34,0-3.5-.95-6.33-2.86-8.49-1.91-2.16-4.87-3.24-8.87-3.24-1.69,0-2.91,.13-3.66,.38Zm17.22,52.32c2.22-2.35,3.33-5.71,3.33-10.09,0-4.75-1.39-8.6-4.18-11.54-2.78-2.94-6.62-4.44-11.5-4.5-3.57-.12-6.85,.03-9.85,.47l2.72-1.03v23.93c0,1.63,.23,2.88,.7,3.75,.47,.88,1.38,1.52,2.72,1.92,1.34,.41,3.3,.61,5.87,.61,4.57,0,7.96-1.17,10.18-3.52Z"/>
          <path class="blog-path" d="M51.99,67.47c0-.38,.09-.56,.28-.56,1.69,0,2.94-.17,3.75-.52,.81-.34,1.38-.97,1.69-1.88,.31-.91,.47-2.27,.47-4.08V11.92c0-2.25-.22-3.88-.66-4.88-.44-1-1.22-1.5-2.35-1.5-.94,0-2.38,.44-4.32,1.31h-.19c-.19,0-.33-.16-.42-.47-.09-.31-.05-.5,.14-.56L62.41,.09c.12-.06,.28-.09,.47-.09s.38,.08,.56,.23c.19,.16,.28,.33,.28,.52V60.44c0,1.82,.14,3.16,.42,4.04,.28,.88,.83,1.5,1.64,1.88,.81,.38,2.06,.56,3.75,.56,.19,0,.28,.19,.28,.56s-.09,.56-.28,.56c-1.38,0-2.5-.03-3.38-.09l-5.26-.09-5.07,.09c-.88,.06-2.06,.09-3.57,.09-.19,0-.28-.19-.28-.56Z"/>
          <path class="blog-path" d="M84.79,66.58c-2.78-1.78-4.93-4.19-6.43-7.23-1.5-3.03-2.25-6.33-2.25-9.9,0-4.07,.99-7.52,2.96-10.37,1.97-2.85,4.5-4.97,7.6-6.38,3.1-1.41,6.24-2.11,9.43-2.11,3.69,0,6.91,.91,9.67,2.72,2.75,1.82,4.86,4.21,6.33,7.18,1.47,2.97,2.21,6.12,2.21,9.43,0,3.88-.91,7.27-2.72,10.18-1.81,2.91-4.24,5.16-7.27,6.76-3.04,1.6-6.33,2.39-9.9,2.39s-6.84-.89-9.62-2.67Zm20.32-2.77c1.88-2.44,2.82-6.19,2.82-11.26,0-3.88-.64-7.35-1.92-10.42-1.28-3.06-3.05-5.46-5.3-7.18-2.25-1.72-4.82-2.58-7.7-2.58-3.38,0-5.99,1.22-7.84,3.66-1.85,2.44-2.77,5.94-2.77,10.51,0,3.82,.62,7.32,1.88,10.51,1.25,3.19,3,5.72,5.25,7.6,2.25,1.88,4.79,2.82,7.6,2.82,3.44,0,6.1-1.22,7.98-3.66Z"/>
          <path class="blog-path" d="M124.39,91.45c-2.47-1.91-3.71-4.4-3.71-7.46,0-5.63,4.79-11.17,14.36-16.61l1.03,1.22c-3.25,1.63-5.74,3.33-7.46,5.11-1.72,1.78-2.58,4.18-2.58,7.18,0,3.25,1.08,5.83,3.24,7.74,2.16,1.91,5.21,2.86,9.15,2.86,4.32,0,7.85-1.14,10.6-3.43,2.75-2.28,4.13-5.33,4.13-9.15,0-2.5-.61-4.33-1.83-5.49-1.22-1.16-2.82-1.89-4.79-2.21-1.97-.31-4.74-.47-8.31-.47-3.44-.06-6.19-.22-8.26-.47-2.06-.25-3.74-.86-5.02-1.83-1.28-.97-1.92-2.45-1.92-4.46s.61-3.78,1.83-5.35c1.22-1.56,3.21-3.38,5.96-5.44l1.03,.84c-1.5,1.19-2.57,2.28-3.19,3.28-.63,1-.94,2.1-.94,3.28,0,1.44,.47,2.53,1.41,3.28,.94,.75,2.45,1.27,4.55,1.55,2.1,.28,5.08,.42,8.96,.42,2.82,0,5.29,.17,7.41,.52,2.13,.34,3.96,1.22,5.49,2.63,1.53,1.41,2.3,3.52,2.3,6.33,0,3.38-1.1,6.52-3.28,9.43-2.19,2.91-5.08,5.22-8.68,6.94-3.6,1.72-7.37,2.58-11.31,2.58-4.32,0-7.71-.95-10.18-2.86Zm5.25-37.54c-2.16-1.09-3.8-2.58-4.93-4.46-1.13-1.88-1.69-3.91-1.69-6.1,0-3.5,1.39-6.41,4.18-8.73,2.78-2.31,6.37-3.47,10.75-3.47,3.19,0,5.83,.58,7.93,1.74,2.1,1.16,3.64,2.66,4.65,4.5,1,1.85,1.5,3.77,1.5,5.77,0,2.19-.61,4.24-1.83,6.15-1.22,1.91-2.94,3.43-5.16,4.55-2.22,1.13-4.8,1.69-7.74,1.69s-5.49-.55-7.65-1.64Zm14.55-1.97c1.28-1.47,1.92-3.71,1.92-6.71,0-3.88-1-6.96-3-9.24-2-2.28-4.47-3.43-7.41-3.43-2.19,0-3.89,.69-5.11,2.06-1.22,1.38-1.83,3.54-1.83,6.48s.5,5.21,1.5,7.18c1,1.97,2.3,3.44,3.89,4.41,1.6,.97,3.24,1.45,4.93,1.45,2.13,0,3.83-.73,5.11-2.21Zm7.7-19.89c1.78-.66,3.74-.99,5.87-.99,.12,0,.23,.22,.33,.66,.09,.44,.14,.91,.14,1.41,0,.75-.08,1.5-.23,2.25-.16,.75-.36,1.06-.61,.94-1.06-.44-2.08-.78-3.05-1.03-.97-.25-2.05-.38-3.24-.38-1.25,0-2.69,.22-4.32,.66l-.84,2.63,.09-3.1c2.13-1.38,4.08-2.39,5.87-3.05Z"/>
        </svg>
      </span>
    </div>
    <div class="blog__contnet">
      <div class="l-section">
        <div class="lcolumn__contentlinner">
          <ul class="column__content js-column">
            {articles.map((item) => {
              return (
                <li class="column__card">
                  <ColumnCard data={item} />
                </li>
              );
            })}
          </ul>

          <div class="u-align-c column__btn">
            <BtnA text="All View" href="/blog" />
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<style lang="scss">
  @import '../styles/vars.scss';

  .blog {
    width: 100%;
    position: relative;
    // padding-top: 0;

    &__inner {
      position: relative;
      
    }

    &__text {
      width: 100%;
      cursor: pointer;
      margin-bottom: vw-pc(50);

      .layer-open {
        display: inline-block;
        width: 100%;
      }

      svg {
        height: vw-pc(200);
        width: auto;

        @include max-screen($bp-sp) {
          height: 8rem;
        }

        path {
          opacity: 0;
          transition: fill 0.5s ease;
        }

      }
    }

    &__heading {
      font-family: "Barlow", sans-serif;
      font-weight: 700;
      font-size: vw-pc(40);
      margin-bottom: vw-pc(80);

      @include max-screen($bp-sp) {
        font-size: 1.4rem;
        margin-bottom: 3rem;
      }
    }
  }

  .column__content {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: vw-pc(30);
    margin-bottom: vw-pc(100);

    @include max-screen($bp-sp) {
      grid-template-columns: 1fr;
      gap: 2rem;
      margin-bottom: 5rem;
    }
  }

  .column__card {
    width: 100%;
  }

  .blog-path {
    fill: #000; 
    transition: fill 0.5s ease;
  }
  
</style>

<script>
  import {
		ScrollTrigger
	} from "gsap/ScrollTrigger";
  import gsap from "../scripts/gsap";

  window.addEventListener('load', () => {
    gsap.registerPlugin(ScrollTrigger);

    function animateSVG(className) {
      const paths = document.querySelectorAll(`.${className}`);

      paths.forEach((path, index) => {
        gsap.fromTo(path,
          { opacity: 0, y: 50, x: 20 },
          {
            opacity: 1,
            y: 0,
            x: 0,
            duration: 0.8,
            delay: index * 0.1,
            scrub: true,
            ease: 'power2.out'
          }      
        );
      });
    }

    function createTrigger(triggerClass, pathClass) {
      ScrollTrigger.create({
        trigger: `#${triggerClass}`,
        start: "top 70%",
        end: "bottom top",
        once: true,
        onEnter: () => animateSVG(pathClass),
      });
    }

    createTrigger('blog', 'blog-path');

  });
</script>